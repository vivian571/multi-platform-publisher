# Multi-Platform Publisher 改进计划

本文档旨在规划和跟踪 `multi-platform-publisher` 项目的后续开发工作，以提升其健壮性、功能性和可维护性。

---

### 高优先级：提升健壮性和可靠性

这些是保证工具稳定运行和长期可维护性的核心。

**1. 实施全面的测试套件**
- **目标**: 为核心业务逻辑（特别是 `publishers` 模块）和工具函数提供单元测试和集成测试。
- **重要性**: 这是**当前最关键的短板**。测试是保证代码质量、防止功能退化和实现安全重构的基石。
- **实施方案**:
    - 使用 `pytest` 框架。
    - 利用 `unittest.mock` 来模拟外部API调用（如 `requests.post`），避免在测试中产生实际的网络请求。
    - 创建一系列测试用的 `.md` 文件，覆盖各种边缘情况。
    - 将测试集成到CI/CD流程中。

**2. 建立发布状态追踪系统**
- **目标**: 记录每篇文章在各平台上的发布状态（是否成功、发布后的URL/ID、内容哈希值）。
- **重要性**: 防止重复发布，并为未来的“更新/删除”功能提供数据基础。
- **实施方案**:
    - 使用本地数据库（如 `sqlite3`）或结构化文件（JSON/YAML）来存储状态。
    - 在发布前，检查文件路径和内容哈希，判断是“创建”还是“更新”。
    - 发布成功后，记录或更新文章的发布信息。

---

### 中优先级：增强功能和用户体验

这些改进能让工具更强大、更灵活、对用户更友好。

**3. 增加手动触发模式**
- **目标**: 允许用户通过命令行直接发布单个文件，而不是只能依赖目录监控。
- **重要性**: 提供更大的灵活性和控制力，方便一次性发布或与其他脚本集成。
- **实施方案**:
    - 扩展 `argparse`，添加 `publish` 子命令，如 `python main.py publish --file <path> --account <name>`。

**4. 优化错误处理和增加重试机制**
- **目标**: 当发布因网络波动等临时性问题失败时，自动进行重试。
- **重要性**: 提高发布成功率，减少因暂时性故障导致的人工干预。
- **实施方案**:
    - 使用 `tenacity` 等库，为网络请求函数添加重试装饰器。

**5. 抽象化内容处理逻辑**
- **目标**: 将Markdown解析、元数据提取等逻辑从各个 `publisher` 中抽离，形成通用模块。
- **重要性**: 减少代码重复，简化 `publisher` 的实现，让其更专注于平台交互。
- **实施方案**:
    - 创建一个 `Content` 类，负责解析文件，并向 `publisher` 提供标准化的内容属性。

---

### 可选/长期规划

这些是更高级的改进，可以在核心功能稳定后再考虑。

**6. 提供Web界面或桌面GUI**
- **目标**: 为工具创建图形用户界面，降低使用门槛。
- **实施方案**:
    - **Web UI**: 使用 Flask 或 FastAPI 搭建。
    - **桌面GUI**: 使用 PyQt, Tkinter 等框架。

**7. 转向异步架构 (`asyncio`)**
- **目标**: 将基于线程池的并发模型重构为基于 `asyncio` 的异步模型，以提升I/O密集型场景下的性能。
- **实施方案**:
    - 重大重构，需将 `requests` 替换为 `httpx`，并改造核心逻辑。
